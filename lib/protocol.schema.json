{
    "title": "ServerMessage",
    "oneOf": [
        { "$ref": "#/definitions/Response" },
        { "$ref": "#/definitions/Event" }
    ],

    "definitions": {
        "Response": {
            "definitions": {
                "Ok": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["Ok"] }
                    },
                    "required": [ "response" ]
                },
                "MessageSent": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["MessageSent"] },
                        "message_id": { "type": "number" }
                    },
                    "required": [ "response", "message_id" ]
                },
                "Info": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["Info"] },
                        "tox_id": { "type": "string" },
                        "name": { "type": "string" },
                        "status": {
                            "enum": [
                                "None",
                                "Away",
                                "Busy"
                            ]
                        },
                        "status_message": { "type": "string" },
                        "friends": {
                            "type": "array",
                            "items": { "$ref": "#/definitions/Friend" }
                        }
                    },
                    "required": [
                        "response",
                        "tox_id",
                        "name",
                        "status",
                        "status_message",
                        "friends"
                    ]
                },
                "AddFriendError": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["AddFriendError"] },
                        "error": {
                            "enum": [
                                "TooLong",
                                "NoMessage",
                                "OwnKey",
                                "AlreadySent",
                                "BadChecksum",
                                "SetNewNospam"
                            ]
                        }
                    },
                    "required": [ "response", "error" ]
                },
                "SendFriendMessageError": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["SendFriendMessageError"] },
                        "error": {
                            "enum": [
                                "NotFound",
                                "NotConnected",
                                "TooLong",
                                "Empty"
                            ]
                        }
                    },
                    "required": [ "response", "error" ]
                },
                "ConferenceInviteError": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["ConferenceInviteError"] },
                        "error": {
                            "enum": [
                                "ConferenceNotFound",
                                "FailSend",
                                "NoConnection"
                            ]
                        }
                    },
                    "required": [ "response", "error" ]
                },
                "ConferenceJoinError": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["ConferenceJoinError"] },
                        "error": {
                            "enum": [
                                "InvalidLength",
                                "WrongType",
                                "FriendNotFound",
                                "Duplicate",
                                "InitFail",
                                "FailSend"
                            ]
                        }
                    },
                    "required": [ "response", "error" ]
                },
                "ConferencePeerQueryError": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["ConferencePeerQueryError"] },
                        "error": {
                            "enum": [
                                "ConferenceNotFound",
                                "PeerNotFound",
                                "PeerQueryNoConnection"
                            ]
                        }
                    },
                    "required": [ "response", "error" ]
                },
                "ConferenceSendError": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["ConferenceSendError"] },
                        "error": {
                            "enum": [
                                "ConferenceNotFound",
                                "TooLong",
                                "NoConnection",
                                "FailSend"
                            ]
                        }
                    },
                    "required": [ "response", "error" ]
                },
                "ConferenceTitleError": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["ConferenceTitleError"] },
                        "error": {
                            "enum": [
                                "ConferenceNotFound",
                                "InvalidLength",
                                "FailSend"
                            ]
                        }
                    },
                    "required": [ "response", "error" ]
                }
            },
            "oneOf": [
                { "$ref": "#/definitions/Response/definitions/Ok" },
                { "$ref": "#/definitions/Response/definitions/Info" },
                { "$ref": "#/definitions/Response/definitions/AddFriendError" },
                { "$ref": "#/definitions/Response/definitions/SendFriendMessageError" },
                { "$ref": "#/definitions/Response/definitions/ConferenceInviteError" },
                { "$ref": "#/definitions/Response/definitions/ConferenceJoinError" },
                { "$ref": "#/definitions/Response/definitions/ConferencePeerQueryError" },
                { "$ref": "#/definitions/Response/definitions/ConferenceSendError" },
                { "$ref": "#/definitions/Response/definitions/ConferenceTitleError" }
            ]
        },
        "Event": {
            "definitions": {
                "ConnectionStatus": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["ConnectionStatus"] },
                        "status": {
                            "enum": [
                                "None",
                                "Tcp",
                                "Udp"
                            ]
                        }
                    },
                    "required": [ "event", "status" ]
                },
                "FriendRequest": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendRequest"] },
                        "public_key": {
                            "type": "array",
                            "items": [{ "type": "number" }]
                        },
                        "message": { "type": "string" }
                    },
                    "required": [ "event", "public_key", "message" ]
                },
                "FriendMessage": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendMessage"] },
                        "friend": { "type": "number" },
                        "kind": { "enum": ["Normal", "Action"] },
                        "message": {"type": "string" }
                    },
                    "required": [ "event", "friend", "kind", "message" ]
                },
                "FriendName": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendName"] },
                        "friend": { "type": "number" },
                        "name": {"type": "string" }
                    },
                    "required": [ "event", "friend", "name" ]
                },
                "FriendStatusMessage": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendStatusMessage"] },
                        "friend": { "type": "number" },
                        "status": {"type": "string" }
                    },
                    "required": [ "event", "friend", "status" ]
                },
                "FriendStatus": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendStatus"] },
                        "friend": { "type": "number" },
                        "status": {
                            "enum": [
                                "None",
                                "Away",
                                "Busy"
                            ]
                        }
                    },
                    "required": [ "event", "friend", "status" ]
                },
                "FriendConnectionStatus": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendConnectionStatus"] },
                        "friend": { "type": "number" },
                        "status": {
                            "enum": [
                                "None",
                                "Tcp",
                                "Udp"
                            ]
                        }
                    },
                    "required": [ "event", "friend", "status" ]
                },
                "FriendTyping": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendTyping"] },
                        "friend": { "type": "number" },
                        "is_typing": { "type": "boolean" }
                    },
                    "required": [ "event", "friend", "is_typing" ]
                },
                "FriendReadReceipt": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendReadReceipt"] },
                        "friend": { "type": "number" },
                        "message_id": { "type": "number" }
                    },
                    "required": [ "event", "friend", "message_id" ]
                },
                "ConferenceInvite": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["ConferenceInvite"] },
                        "friend": { "type": "number" },
                        "kind": { "enum": ["Text", "Av"] },
                        "cookie": {
                            "type": "string",
                            "contentEncoding": "base64"
                        }
                    },
                    "required": [ "event", "friend", "kind", "cookie" ]
                },
                "ConferenceConnected": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["ConferenceConnected"] },
                        "conference": { "type": "number" }
                    },
                    "required": [ "event", "conference" ]
                },
                "ConferenceMessage": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["ConferenceMessage"] },
                        "conference": { "type": "number" },
                        "peer": { "type": "number" },
                        "kind": { "enum": ["Normal", "Action"] },
                        "message": { "type": "string" }
                    },
                    "required": [ "event", "conference", "peer", "kind", "message" ]
                },
                "ConferenceTitle": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["ConferenceTitle"] },
                        "conference": { "type": "number" },
                        "peer": { "type": "number" },
                        "title": { "type": "string" }
                    },
                    "required": [ "event", "conference", "peer", "title" ]
                },
                "ConferencePeerName": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["ConferencePeerName"] },
                        "conference": { "type": "number" },
                        "peer": { "type": "number" },
                        "name": { "type": "string" }
                    },
                    "required": [ "event", "conference", "peer", "name" ]
                },
                "ConferencePeerListChanged": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["ConferencePeerListChanged"] },
                        "conference": { "type": "number" }
                    },
                    "required": [ "event", "conference" ]
                }
            },
            "oneOf": [
                { "$ref": "#/definitions/Event/definitions/ConnectionStatus" },
                { "$ref": "#/definitions/Event/definitions/FriendRequest" },
                { "$ref": "#/definitions/Event/definitions/FriendMessage" },
                { "$ref": "#/definitions/Event/definitions/FriendName" },
                { "$ref": "#/definitions/Event/definitions/FriendStatusMessage" },
                { "$ref": "#/definitions/Event/definitions/FriendStatus" },
                { "$ref": "#/definitions/Event/definitions/FriendConnectionStatus" },
                { "$ref": "#/definitions/Event/definitions/FriendTyping" },
                { "$ref": "#/definitions/Event/definitions/FriendReadReceipt" },
                { "$ref": "#/definitions/Event/definitions/ConferenceInvite" },
                { "$ref": "#/definitions/Event/definitions/ConferenceConnected" },
                { "$ref": "#/definitions/Event/definitions/ConferenceMessage" },
                { "$ref": "#/definitions/Event/definitions/ConferenceTitle" },
                { "$ref": "#/definitions/Event/definitions/ConferencePeerName" },
                { "$ref": "#/definitions/Event/definitions/ConferencePeerListChanged" }
            ]
        },
        "Friend": {
            "type": "object",
            "properties": {
                "number": { "type": "number" },
                "public_key": { "type": "string" },
                "name": { "type": "string" },
                "status": {
                    "enum": [
                        "None",
                        "Away",
                        "Busy"
                    ]
                },
                "status_message": { "type": "string" },
                "last_online": { "type": "number" }
            },
            "required": [
                "number",
                "public_key",
                "name",
                "status",
                "status_message",
                "last_online"
            ]
        }
    }
}
