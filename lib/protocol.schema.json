{
    "title": "ServerMessage",
    "oneOf": [
        { "$ref": "#/definitions/Response" },
        { "$ref": "#/definitions/Event" }
    ],

    "definitions": {
        "Response": {
            "definitions": {
                "Ok": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["Ok"] }
                    },
                    "required": [ "response" ]
                },
                "MessageSent": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["MessageSent"] },
                        "message_id": { "type": "number" }
                    },
                    "required": [ "response", "message_id" ]
                },
                "Info": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["Info"] },
                        "tox_id": { "type": "string" },
                        "name": { "type": "string" },
                        "status": {
                            "enum": [
                                "None",
                                "Away",
                                "Busy"
                            ]
                        },
                        "status_message": { "type": "string" },
                        "friends": {
                            "type": "array",
                            "items": { "$ref": "#/definitions/Friend" }
                        }
                    },
                    "required": [
                        "response",
                        "tox_id",
                        "name",
                        "status",
                        "status_message",
                        "friends"
                    ]
                },
                "AddFriendError": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["AddFriendError"] },
                        "error": {
                            "enum": [
                                "TooLong",
                                "NoMessage",
                                "OwnKey",
                                "AlreadySent",
                                "BadChecksum",
                                "SetNewNospam"
                            ]
                        }
                    },
                    "required": [ "response", "error" ]
                },
                "SendFriendMessage": {
                    "type": "object",
                    "properties": {
                        "response": { "enum": ["SendFriendMessage"] },
                        "error": {
                            "enum": [
                                "NotFound",
                                "NotConnected",
                                "TooLong",
                                "Empty"
                            ]
                        }
                    },
                    "required": [ "response", "error" ]
                }
            },
            "oneOf": [
                { "$ref": "#/definitions/Response/definitions/Ok" },
                { "$ref": "#/definitions/Response/definitions/Info" },
                { "$ref": "#/definitions/Response/definitions/AddFriendError" },
                { "$ref": "#/definitions/Response/definitions/SendFriendMessage" }
            ]
        },
        "Event": {
            "definitions": {
                "ConnectionStatus": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["ConnectionStatus"] },
                        "status": {
                            "enum": [
                                "None",
                                "Tcp",
                                "Udp"
                            ]
                        }
                    },
                    "required": [ "event", "status" ]
                },
                "FriendRequest": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendRequest"] },
                        "public_key": {
                            "type": "array",
                            "items": [{ "type": "number" }]
                        },
                        "message": { "type": "string" }
                    },
                    "required": [ "event", "public_key", "message" ]
                },
                "FriendMessage": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendMessage"] },
                        "friend": { "type": "number" },
                        "kind": { "enum": ["Normal", "Action"] },
                        "message": {"type": "string" }
                    },
                    "required": [ "event", "friend", "kind", "message" ]
                },
                "FriendName": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendName"] },
                        "friend": { "type": "number" },
                        "name": {"type": "string" }
                    },
                    "required": [ "event", "friend", "name" ]
                },
                "FriendStatusMessage": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendStatusMessage"] },
                        "friend": { "type": "number" },
                        "status": {"type": "string" }
                    },
                    "required": [ "event", "friend", "status" ]
                },
                "FriendStatus": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendStatus"] },
                        "friend": { "type": "number" },
                        "status": {
                            "enum": [
                                "None",
                                "Away",
                                "Busy"
                            ]
                        }
                    },
                    "required": [ "event", "friend", "status" ]
                },
                "FriendConnectionStatus": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendConnectionStatus"] },
                        "friend": { "type": "number" },
                        "status": {
                            "enum": [
                                "None",
                                "Tcp",
                                "Udp"
                            ]
                        }
                    },
                    "required": [ "event", "friend", "status" ]
                },
                "FriendTyping": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendTyping"] },
                        "friend": { "type": "number" },
                        "is_typing": { "type": "boolean" }
                    },
                    "required": [ "event", "friend", "is_typing" ]
                },
                "FriendReadReceipt": {
                    "type": "object",
                    "properties": {
                        "event": { "enum": ["FriendReadReceipt"] },
                        "friend": { "type": "number" },
                        "message_id": { "type": "number" }
                    },
                    "required": [ "event", "friend", "message_id" ]
                }
            },
            "oneOf": [
                { "$ref": "#/definitions/Event/definitions/ConnectionStatus" },
                { "$ref": "#/definitions/Event/definitions/FriendRequest" },
                { "$ref": "#/definitions/Event/definitions/FriendMessage" },
                { "$ref": "#/definitions/Event/definitions/FriendName" },
                { "$ref": "#/definitions/Event/definitions/FriendStatusMessage" },
                { "$ref": "#/definitions/Event/definitions/FriendStatus" },
                { "$ref": "#/definitions/Event/definitions/FriendConnectionStatus" },
                { "$ref": "#/definitions/Event/definitions/FriendTyping" },
                { "$ref": "#/definitions/Event/definitions/FriendReadReceipt" }
            ]
        },
        "Friend": {
            "type": "object",
            "properties": {
                "number": { "type": "number" },
                "public_key": { "type": "string" },
                "name": { "type": "string" },
                "status": {
                    "enum": [
                        "None",
                        "Away",
                        "Busy"
                    ]
                },
                "status_message": { "type": "string" },
                "last_online": { "type": "number" }
            },
            "required": [
                "number",
                "public_key",
                "name",
                "status",
                "status_message",
                "last_online"
            ]
        }
    }
}
